<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
   <meta name="GENERATOR" content="Mozilla/4.73 [ja] (Win98; U) [Netscape]">

   <script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

   <title>線型代数II</title>
<link rel="stylesheet" type="text/css" href="../latex.css" />
</head>
<body bgcolor="#FFFFCC">
<h2>
線型代数２０２３授業日誌
</h2>
神も仏もいらぬが、せめて調和の世界を人類の生死を超えてなお。
<!--混沌のゆくへはいずこか、理性の光こそが。-->
<a target="_blank" href="./senkei2023aki.pdf">秋の進度予定表</a>と
<a target="_blank" href="./linear2023.pdf">定まりなき世のための講義ノート</a>を道の糧に、倒れゆくもまた。
<p>
ネット上の参考書など
<ol>
<li>
Chen 先生の
<a target="_blank" href="http://www.williamchen-mathematics.info/lnlafolder/lnla.html">
  講義ノート</a>は、基本の計算も説明も丁寧。</li>
<li>
あの SEGA が
<a target="_blank" href="https://techblog.sega.jp/entry/2021/06/15/100000">基礎線形代数講座</a>
を公開しています。もともとは、3D のための数学の勉強会だったようですが、高校数学の復習とか歴史的コメントも沢山入っていて、なかなかの労作です。
感心しました。
<!--
<li>
Beezer 先生の
<a target="_blank" href="http://linear.ups.edu/html/fcla.html">
A First Course in Linear Algebra</a>
というのもある。これは、項目が飛び出す方式の電子教科書とでもいったもので、
面白い趣向なれど、初めて学ぶ人には印刷して使える形の方が便利であろう。</li>
-->
</ol>
<p>
  今期は、予習＋講義＋復習の「半転授業」を志向します。
  <br>
  予復習は<a target="_blank" href="./laa2023.pdf">要約（続行列代数）</a>と講義ノートで教室の外にて。
  実講義（４０分＋４０分）は事前学習を前提に、考え方・計算のコツなどを伝える予定です。
</p>
<ul>
<li>
<a href="#l0">１０月０５日</a>（前期の復習と後期の見通し）</li>
<li>
<a href="#l1">１０月１２日</a>（固有値と固有ベクトル）</li>
<li>
<a href="#l2">１０月１９日</a>（複素数の数学）</li>
<li>
<a href="#l3">１０月２６日</a>（行列の対角化）</li>
<li>
<a href="#l4">１１月０２日</a>（まとめと試験１）</li>
<li>
<a href="#l5">１１月０９日</a>（内積の幾何学）</li>
<li>
<a href="#l6">１１月１６日</a>（直交基底と直交行列）</li>
<li>
<a href="#l7">１２月０７日</a>（対称行列と二次形式）</li>
<li>
<a href="#l8">１２月１４日</a>（まとめと試験２）</li>
<li>
<a href="#l9">１２月２１日</a>（ベクトル空間と基底）</li>
<li>
<a href="#l10">１２月２５日</a>（一次変換と行列）</li>
<li>
<a href="#l11">１月１１日</a>（まとめと試験３）</li>
<li>
<a href="#l12">１月１８日</a>（固有空間と不変部分空間）</li>
<li>
<a href="#l13">１月２５日</a>（確率行列）</li>
<li>
<a href="#l14">２月０１日</a>（期末試験）</li>
</ul>
<hr>


<h3>
  <a NAME="l0"></a>１０月５日（前期の復習と後期の見通し）</h3>
<p>
  前期は、行列と行列式にまつわる計算が主な内容でした。その全体を統制する技に、連立一次方程式の掃き出しによる解法があります。
  まず、掃き出し法の内容を復習していただきます。
  <br>
  テキストで言えば、７節になります。斉次型の連立一次方程式の解法がとりわけ重要で、
  その解集合（解空間）の性質（掃き出し定理）を思い出しておきます。
  <br>
  次いで、正方行列と掃き出し定理、それと逆行列の関係をまとめたもの（行列代数の基本定理）も再確認しておきます。
  次の３つのものが何であって、それがどのように関係するか。
  \[
  A^{-1},\quad \hbox{rank}(A),\quad \det(A)
  \]
 </p>


<h3>
<a NAME="l1"></a>１０月１２日（固有値と固有ベクトル）</h3>
<p>
季節は急進し、萩をめでる暇もなく。
<p>
  本日は、前期の最後にふれてもよかった固有値・固有ベクトルの話題から。
  それを調べるための道具としての固有多項式とその実例。応用としては、連立漸化式。
  要約の問は、必ずやっておくこと。
 余裕があれば、テキストで＃記号がついている問（今回であれば 10.3, 10.4）もどうぞ。
<br>
来週は、その続きとしての複素数の数学から。
<p>
  テキストで固有値と固有ベクトルの英語が反対になっているのでは、という質問を受けました。
  これは、「固有値 $\lambda$ の固有ベクトル」という言い方のせいで、どこまでが一つの語句かわかりにくかったためでした。
  紛れのないように修正したものを上げておきましたので、ご参照ください。
</p>


<h3>
  <a NAME="l2"></a>１０月１９日（複素数の数学）</h3>
<p>
しばらくは晴天がつづくか、今日は御岳日和。
<p>
  本日のメニュー：
<br> 
複素数の極表示、オイラーの公式、固有値の存在。
<br>
複素数とはこれを機会に仲良くしておくとよい。
高校の内容の復習も含めて。
振動現象の記述にも役立つのみならず、自然はこの複素数の形で我々に姿を見せる、
というのは量子力学の教えるところ。
</p>

<h3>
<a NAME="l3"></a>１０月２６日（行列の対角化）</h3>
<p>
  鈴鹿の山なみもくっきりといわし雲。
<p>
  対角行列とべき、行列の対角化とべき、対角化と固有値・固有ベクトル、
  基底と逆行列の復習
  <br>
  ２次行列の例をいくつか。
バネの連成振動については各自で研究してみてください。
<p>
  来週は、まとめと試験（４０分二問）。２回目と４回目（今日）を重点的に復習しておいてください。
<p> open text というのを見つけたので URL を出しておきます。
  <a target="_blank" href="https://lyryx.com/wp-content/uploads/2018/01/Nicholson-OpenLAWA-2018A.pdf">
    Nicholson </a>
  典型的な米国の教科書のようで、計算ドリルとして使えるかも知れません。
</p>

<h3>
<a NAME="l4"></a>１１月０２日（まとめと試験１）</h3>
<p>
秋は一段と、雪山も晴れ晴れと。
<p>
  今日は、復習と補習（固有値・固有ベクトル、行列の対角化、固有ベクトルの一次独立性）の後に
  １回目の試験でした。
  <!--
  <a target="_blank" href="./linear2022aki-1.pdf">試験１</a>でした。
-->
<p>
  [講評]:一部不勉強な人もいましたが、全体としてはまずまずでしょうか。
  <br>
  $\fbox{1}$ (ii) ができない人がちらほら。
  (iii) では $A$ の対角化を求めて、余計な計算するもの多し。
    <br>
    $\fbox{2}$ 対角化を与える行列を $P$ と書くものきわめて多し。また行列を角括弧で書いたり。
    あまりにもテキストを無視すると、後々齟齬が生じないかと。
    枠にはめる本ではなく、枠から飛び出す気持ちを、といったところ。
</p>

<h3>
<a NAME="l5"></a>１１月０９日（内積の幾何学）</h3>
<p>
異常なる高温は、まだ終わらず。もっとも異常なることは、異常なことを異常とも思わぬ理性の陰り。
 <p>
本日のメニュー：
<br>
内積の復習からはじまって、様々な実例、そして内積の不等式。
具体的なベクトルと抽象的なベクトル。
ちょっとした応用として、データ解析の基本事項でもある、平均、分散、標準偏差に相関係数。
<br> 線型代数の本には、抽象的なベクトル空間がお決まりのように取り上げられているのだが、これは数学関係者の趣味と言ってよいかも知れない。
ただ抽象的な理解はしばしば必要ともなるのであるが、１次結合、これが何らかの意味で可能な対象がベクトルの根源的な要請事項で、
一次結合が可能なベクトルの集団をベクトル空間という、くらいに思っておいて良い。
ベクトルおよびベクトル空間の具体例は、数を一定個数並べたもので、数ベクトル空間という。
<br>
他にも列挙しておくと、数列全体、関数全体、幾何ベクトル（変位ベクトル）、物理的ベクトル（測度、電界、力）。
<br> 普通異なる種類のベクトルの一次結合は考えない。具体的には、力と速度ベクトルを混ぜない、というか混ぜてはいけないことに注意。
<br>
繰り返すと、ベクトルとは一次結合が滞りなく行えるもののことである。
したがって、平面とか空間の平行移動を表わす量もベクトルということになるが、こういった幾何学的なベクトルでは、
ベクトルの大きさとか２つのベクトルの成す角よいった幾何学的な量を合わせ考えることができる。
<br>
こういった追加の幾何学的情報を抽象化したものが、ベクトルの間の内積と呼ばれるもので、その性質を列挙すれば、
(i) 対称性、(ii) 分配法則、(iii) 正値性で、代数的な (i), (ii) に、大小を規定する (iii) をつないだものが、
その本質である。
<br> 
１３節からあちらこちらつまみ食い。
<br>
ここでは実数をスカラーとするベクトルを扱ったが、スカラーを複素数にまで拡張することも可能で、しかも意味のあることではある。
</p>

<h3>
<a NAME="l6"></a>１１月１６日（直交基底と直交行列）</h3>
<p>
  遠くの山なみはうすら青く、かえでの紅も数えるほどに。
<p>
  本日のメニュー：部分空間と直交補空間、直交分解、直交基底と直交行列です。少し盛りたくさん。
<p>
  テキストの関連箇所も挙げておきます。拾い読みで良いので目を通しておくと良いことがあるかも知れない。
  <br>
  §２ 直線と平面の幾何学（前期の初めに少し触れたのですが、座標系の扱いをもう一度復習）。
  <br>
  転置行列の性質 p.18, p.29
  <br>
  §１６ 平面と空間の一次式変換。
<p>
  前回の内積の幾何学の内容を受けて、要約の５節に従って見ていきます。
  <br>
  まず、数ベクトル空間 $R^n$ の標準内積を復習します。今日は、これを $R^n$ の部分空間 $V$ に制限したものを考えます。
  <br>
  $R^n$ のベクトルの集まり $M$ に対して、すべての $y \in M$ と直交する $x \in R^n$ 全体を $M^\perp$ で表します。
  $M = \{ a_1,\dots,a_m\}$ のとき、これらを横ベクトルとして $m$ 行並べた $m\times n$ 行列を $A$ とすると、
  \begin{align*}
  x \in M^\perp &\Longleftrightarrow (a_1|x) = \dots = (a_m|x) = 0\\
  &\Longleftrightarrow Ax = 0
\end{align*}
  となるので、$M^\perp$ は連立一次方程式 $Ax = 0$ の解空間（前期の内容です）に他ならず、$R^n$ の部分空間となります。
<p>
  $V$ に含まれるベクトルの列 $u_1,\dots,u_m$ で
  \[
  (u_i|u_k) = \delta_{j,k} = 
  \begin{cases}
  1 & (j=k)\\
  0 & (j \not=k)
  \end{cases}
  \]
  となるものを $V$ の正規直交系 (OrthoNormal System) といいます。
  <br>
  $V$ の正規直交系でその個数が最大であるものを $V$ の正規直交基底 (OrthoNormal Basis) といい、そのときの個数を $V$ の次元であると定めます。
  <br>
  連立一次方程式の解空間の場合、その次元と一致するのですが、ここでは深入りしないでおきます。
  <br>
  （テキストを通して読むとそれが見えるようにはなっているのですが。）
<p>
  $R^3$ であれば、互いに直交して大きさが $1$ のベクトルを３つ並べたものが、$R^3$ の正規直交基底ということになります。
<p>
  以上の準備の下、今日の中心の話題である直交分解定理に入ります。
  <br>
  まずは、文章による説明のあとで、図を使った解説を行います。
<br>
<b>定理</b> 部分空間 $V \subset R^n$ について、そのベクトル $x \in R^n$ も
\[
x = x_\parallel + x_\perp\quad (x_\parallel \in V, x_\perp \in V^\perp)
\]
の形で表わすことができ、その表し方は一つしかない。$x_\parallel$ を $x$ の $V$ への（正）射影という（projection)。
  <br>
  ここで、３次元 ($n=3$) の場合のイメージを図にしておきます。
  <br>
  まず、原点を通る平面を $V$ とします。
  <br>
  そうすると、$V^\perp$ は同じく原点を通る直線で $V$ と直交するものになります。
  <br>
  そのとき、一般の空間ベクトルは $V$ 方向の部分と $V^\perp$ 方向の部分に分解されるというのが上の定理の内容です。
<p>
  証明はテキストの該当箇所にありますが、今の場合に即して書いておくと次のようになります。
  <br>
  まず、$V$ の正規直交基底 $u_1,\dots,u_m$ を一組用意します。もし、$x \in R^n$ が
  \[
  x = t_1u_1 + \dots + t_m u_m + x_\perp
  \quad (t_j \in R, x_\perp \in V^\perp)
  \]
  のように表わされたとすると。$u_j$ と 両辺との内積から、$t_j = (u_j|x)$ が出ます。
  <br>
  ということで、$x_\parallel$ は $x$ で定まり、
  \[
  x_\parallel =
  \]
  と表わされます。そこで、$x_\perp = x - x_\parallel$ と置くと、
  \[
  (u_j|x^\perp) = (u_u|x) - (u_j|x) = 0
  \]
  であることから、$x_\perp \in V^\perp$ であることがわかり、すべてが一通りに決まることもわかります。
<p>
  上の分解定理から $(V^\perp)^\perp = V$ であることもわかります。
  <br>
  まず意味から $V \subset (V^\perp)^\perp$ ですが、
  $x \in (V^\perp)^\perp$ を定理により直交分解すると、
  $x_\perp = 0$ でなければならないのがその理由です。
<p>
  さて、上の定理の証明は、$x$ の $V$ への射影が $V$ の正規直交基底を使って具体的に書けることを示している点でも重要です。
  <br>
  このことを例を通して実感していただきます。
<p>
  <b> 例 </b>
  $u_1 = \frac{1}{\sqrt{3}} (1,1,1)$ を含む $R^3$ の ONB を沢山作れ。
<p>
  $u_1$ で表されないベクトル、例えば $a = (1,0,0)$ を取ってきて、その直交分解を考えると、
  \[
  a - (u_1|a)u_1 
  = (1,0,0 - \frac{1}{3}(1,1,1) = \frac{1}{3}(2,-1,-1)
  \]
  が $u_1$ と直交することがわかります。そこで、これを単位ベクトル化した
  \[
  \frac{1}{\sqrt{2^2+1+1}} (2,-1,-1) = \frac{1}{\sqrt{6}} (2,-1,-1)
  \]
  を $u_2$ とすると、正規直交系 $u_1,u_2$ が得られました。
  <br>
  さらに、$u_1$, $u_2$ の一次結合で表わされない（と思われる）$b = (0,1,0)$ から
  \[
  b - (u_1|b)u_1 - (u_2|b)u_2 = (0,1,0) - \frac{1}{3} (1,1,1) - \frac{1}{6}(-1) (2,-1,-1)
  = \frac{1}{2} (0,1,-1)
  \]
 </p>
を作ると、これは $u_1$, $u_2$ のいずれとも直交するので、単位ベクトル化けさせた
\[
u_3 = \frac{1}{\sqrt{2}} (0,1,-1)
\]
が求める第３のベクトルとなり、正規直交基底 $u_1,u_2,u_3$ が得られました。
<p>
  途中で利用する $a$, $b$ をいろいろと取り替えることで、$u_1$ を含むさまざまな正規直交基底が得られることを実感します。
  <br>
  これを宿題とします。（もう少し続く）
<p>
  最後に、正規直交基底と直交行列の関係を調べてお終いです。
  <br>
  こんどは $u_1, \dots, u_m$ を縦ベクトルと見て横に $m$ 個並べた $n\times m$ 行列を $T$ とします。
  そうすると、
  \[
  {}^tT T = ((u_j|u_k))_{1 \leq j,k \leq m}
  \]
  と表されるので、$u_1,\dots, u_m$ が ONS であることと ${}^tT T = I_m$ が同値になります。
  <br>
  とくに、$m=n$ のとき、$u_1,\dots,u_n$ が $R^n$ の ONB であることと $T^{-1} = {}^tT$ となることは同値。
  <br>
  このような行列を直交行列 (orthogonal matrix) といいます。（「正規」がどこかに消えてしまいました。）
<p>
  <b>例 </b>
  \[
  \begin{pmatrix}
  \cos\theta & -\sin\theta\\
  \sin\theta & \cos\theta
  \end{pmatrix},
  \quad
  \begin{pmatrix}
  \cos 2\theta & \sin 2\theta\\
  \sin 2\theta & - \cos 2\theta
  \end{pmatrix}
  \]
  最初の行列は角 $\theta$ の回転を、後の行列は、直線 $y = x \tan\theta$ に関する折返しを表します。
  <br>
  「回転行列」によりベクトル $(1,0)$, $(0,1)$ の行き先を図示し、回転であることを確かめよ。
  <br>
  ベクトル $(\cos\theta,\sin\theta)$, $(-\sin\theta,\cos\theta)$ が「折り返し行列」の固有ベクトルであることを確かめよ。
 </P>



<h3>
  <a NAME="l7"></a>１２月０７日（対称行列と二次形式）</h3>
<p>季節は前に、木枯らしの響きもまた御嶽日和。
  <p>本日のメニュー：
  <br> 対称行列の直交対角化
  <br> です。ここは、丁寧にやるとかなり長くなるところなのですが、気合で一気に説明する予定。
  そのあらましを以下に書きますので、参考にして、間を適宜埋めていただきます。
  手取り足取りから脱するよい機会でもあります。ただ、どうにも詰まったときは、メールにてできるだけ具体的にご相談ください。
<p>
  まず、前回の補足として、直交座標変換を学びます。これは２次元だと、座標の回転とか（ある直線に関する）折返しということになっていて、
  もとの座標と新たな座標が直交行列で結ばれるという構図になっています。
<p> 一般の場合も似たようなものですが、３次元の場合を思うのでも十分です。これを直接扱うことはあまり多くはないかも知れませんが、
  直感が働く場合を具体的に経験しておくことは意味があります。
<p> 次に二次形式というものを導入します。これも一般の場合よりも、２変数・３変数で実感をつかみます。
  概要には２変数の場合が書いてあるので、それが３変数の場合にどのように書けるかやってみます。
<p>
  次に２変数の場合に、回転を施した新しい座標で、二次形式の形がどのように変化するか調べます。例6.3 のところです。
  回転角を適切に選んで、二次形式が対角型になることを実感します。
<p>
  変数の数が増えた場合も直交変換により同様の手続きが可能であるというのが、定理6.4 の内容です。
  その証明には、半内積の不等式に直交分解を組み合わせた議論を使います。
  ここのところの一般論がわかりにくければ、３変数（あるいは２変数）の場合に限定して何をしているのかを読み取るとよいでしょう。
<p>
  来週は、２回目の試験です。試験範囲は、過去３回分の授業内容。
<p>
  Q:二次形式の標準形の極値問題への応用について質問です。
  二次形式を直交行列を用いた対角化によって標準形に直した後、どのように極値を判定するのかがわかりません。
  <br>
  A: これは、微積分の該当箇所と照らし合せて勉強します。
  次がわかりやすいでしょうか。
   <a target="_blank" href="https://math-fun.net/20210121/9410/">math-fun.net</a>
<br>
答えは、
<br>
(i) 固有値が２つとも正であれば、極小。
<br>
(ii) 固有値が２つとも負であれば、極大。
<br>
(iii) 固有値が正負に分かれたときは、極値にならない（が鞍点というものになる）。
<br>
です。
<p>
  昨日から咳が出て喉も痛くなってきたので、申し訳ありませんが、
  明日１１月３０日の授業は臨時休講とし、１２月の予定を１週間遅らせて実施することにいたします。
<p>
  ただし、年内最後の授業は補講で行います。いまのところ、１２月２５日（月）が候補ですが、時間その他は、
  これから詰めてみることになります。
</p>


<h3>
<a NAME="l8"></a>１２月１４日（まとめと試験２）</h3>
<p>
本日は、復習のあとに２回めの試験でした。
<!-- <a target="_blank" href="./linear202aki-2.pdf">２回目の試験</a>。-->
<p>
  補講のお知らせです。１２月２５日（月）の、
  <br>
  10:30--12:00 と 13:00--14:30 の２回行います。
  <br>
  内容は同じなので、午前か午後の都合のよい方で受けてください。
  <br>
  どちらも都合の悪い人は、ここに内容の解説を置いておくので、それで勉強していただいても構いません。
  <br>
  質問等はメールで受け付けます。
 <p>
   [試験の講評] $\fbox{1}$ は、直交関係の基本を問うものでしたが、「一組の正規直交基底」で何を要求されているのかが不十分の人がかなりの人数に。
  <br>
  $\fbox{2}$ は一転して、パターン化で処理できることもあり、まずまずだったでしょうか。
  それでも、二次形式の書き直し（変数変換）について書いてある人は多くありませんでした。その辺りがボーナス点の境目でした。
  </p>


<h3>
<a NAME="l9"></a>１２月２１日（ベクトル空間と基底）</h3>
<p>
今日も穏やかに晴れわたり、落ち葉も一段と。
<p>本日のメニュー
  <br>
  ベクトル空間、基底、ベクトルの成分表示、基底の変換行列と成分の変換式
  <br>
  です。
<p>
  基本的な表示式を書いておきます。
  <br>
  基底ベクトル $f_1,\dots,f_n$ を使って、ベクトル $v$ の成分表示をするときは、
  \[
  v = t_1f_1 + \dots + t_n f_n = (f_1,\dots,f_n)
  \begin{pmatrix}
  t_1\\
  \vdots\\
  t_n
  \end{pmatrix}
  \]
  のように書きます。
  <br>
  こうすることで、行列計算が便利に使えて、基底変換行列と成分の変換式の関係が明快になります。具体的には
  \[
  \begin{pmatrix}
  f_1 & \dots & f_n
  \end{pmatrix}
  = \begin{pmatrix}
  e_1 & \dots & e_n
  \end{pmatrix}
  \begin{pmatrix}
  t_{11} & \dots & t_{1n}\\
  \vdots & \ddots & \vdots\\
  t_{n1} & \dots & t_{nn}
  \end{pmatrix}
  \]
  で基底変換行列 $(t_{ij})$ を定めると、それぞれの基底に関する成分 $(x_i)$, $(y_i)$ は、
  \[
  \begin{pmatrix}
  e_1 & \dots & e_n
  \end{pmatrix}
  \begin{pmatrix}
  x_1\\
  \vdots\\
  x_n
  \end{pmatrix}
  =
   \begin{pmatrix}
  f_1 & \dots & f_n
  \end{pmatrix}
  \begin{pmatrix}
  y_1\\
  \vdots\\
  y_n
  \end{pmatrix}
   = \begin{pmatrix}
  e_1 & \dots & e_n
  \end{pmatrix}
  \begin{pmatrix}
  t_{11} & \dots & t_{1n}\\
  \vdots & \ddots & \vdots\\
  t_{n1} & \dots & t_{nn}
  \end{pmatrix}
  \begin{pmatrix}
  y_1\\
  \vdots\\
  y_n
  \end{pmatrix}
  \]
  より、
  \[
 \begin{pmatrix}
  x_1\\
  \vdots\\
  x_n
  \end{pmatrix}
 =  \begin{pmatrix}
  t_{11} & \dots & t_{1n}\\
  \vdots & \ddots & \vdots\\
  t_{n1} & \dots & t_{nn}
  \end{pmatrix}
  \begin{pmatrix}
  y_1\\
  \vdots\\
  y_n
  \end{pmatrix}
  \Longleftrightarrow
   \begin{pmatrix}
  y_1\\
  \vdots\\
  y_n
  \end{pmatrix}
 = \begin{pmatrix}
  t_{11} & \dots & t_{1n}\\
  \vdots & \ddots & \vdots\\
  t_{n1} & \dots & t_{nn}
  \end{pmatrix}^{-1}
  \begin{pmatrix}
  x_1\\
  \vdots\\
  x_n
  \end{pmatrix}
  \]
  がわかります。
  <br>
  以上のことを具体例で確認していきます。
</p>


<h3>
<a NAME="l10"></a>１２月２５日（一次変換と行列）</h3>
<p>
 はや冬至も過ぎ、鈴鹿の山も白さをまし、寒さも修正を繰り返しながら。
<p>
  本日のメニュー：一次変換、基底、表示行列、基底の取りかえによる表示行列の変換
  <br>
  でした。テキストだと１２節の辺り。
  <br>
  実は、変換の前に「写像」というのを学ぶのが順序というものでした。
  <br>
  時間の関係で詳しくはできないのですが、基本的なことは難しくないので、
  例えば、<a target="_blank" href="https://www.math.nagoya-u.ac.jp/~yamagami/teaching/set2018.pdf">これ</a>でも見てください。
  <br>
  テキストの付録にも少し書いてあります。
  <p>
  さて、ベクトル空間 $V$ における変換 $\phi:V \to V$ で、一次結合を保つもの、すなわち、
  \[
  \phi(t_1v_1+ \dots + t_m v_n) = t_1\phi(v_1) + \dots + t_m \phi(v_m)
  \]
  となるものを一次変換（線型作用素）という。
  $V$ のベクトルを並べたもの $(v_1,\dots,v_m)$ と $m\times n$ 行列 $A$ の積を
  \[
  (v_1,\dots,v_m)A = (\sum_i v_i a_{i1}, \dots, \sum_i v_i a_{in})
  \]
  で定め、さらに $\phi$ の左からの積を
  \[
  \phi(v_1,\dots, v_m) = (\phi(v_1),\dots, \phi(v_m))
  \]
  で与えると、線型性の言い換えとして次が成り立つ
  \[
  \phi((v_1,\dots,v_m)A) = \phi ((v_1,\dots,v_m)A). 
  \]
  <p>
  前回は、ベクトルの成分が基底の取り換えでどう変化するかを調べた。
  <br>
  今日は、一次変換の「成分表示」と、それが基底の取り換えでどう変化するかが問題。
  <br>
  $V$ の基底 $(f_1,\dots,f_n)$ が用意されていると、各ベクトル $\phi(f_j)$ をこの基底に関して
  \[
  \phi(f_j) = \sum_i b_{i,j} f_i 
  \]
  と表示し、正方行列を $B = (b_{i,j})$ で定めると、
  \[
  (\phi(f_1),\dots, \phi(f_n)) = (f_1,\dots,f_n) B.
  \]
  これを、形式的に $\phi(f_1,\dots,f_n) = (f_1,\dots,f_n)B$ と書けば、
  \[
  \phi = (f_1,\dots,f_n) B (f_1,\dots, f_n)^{-1} \iff
  (f_1,\dots,f_n)^{-1}\phi(f_1,\dots,f_n) = B
  \]
  という関係が見えてくる。
  すなわち、$V$ の基底 $(f_1,\dots,f_n)$ を介して、$\phi$ が行列 $B$ で表される。
  <br>
  これを $\phi$ の基底 $(f_1,\dots,f_n)$ に関する表現行列あるいは
  表示行列という。
<p>
  例として、$V = R^n$ の一次変換 $\phi$ を、正方行列 $A$ を左から掛けることで $\phi(x) = Ax$ により定める。
  <br>
  標準基底を並べたもの $(e_1,\dots,e_n)$ が単位行列 $I_n$ によって表されることに注意して、
  \[
  (\phi(e_1),\dots, \phi(e_n)) = (Ae_1,\dots,Ae_n) = (e_1,\dots,e_n) A
  \]
  と計算すれば、$\phi$ の $(e_1,\dots, e_n)$ に関する表示行列は $A$ そのものであることがわかる。
<p>
  この段階では堂々巡りの計算になっていて、行列を一次変換に言い換えただけのものであるが、
  <br>
  標準基底以外の基底 $(f_1,\dots,f_n)$ を、取り替え行列 $T$ により $(f_1,\dots,f_n) = (e_1,\dots,e_n)T$ と表わして、
  <br>
  上の形式的な計算を続けると、$\phi$ の線型性により、
\[
(f_1,\dots,f_n)B = \phi (f_1,\dots, f_n) = \phi ((e_1,\dots,e_n)T) = (\phi(e_1,\dots,e_n))T = (e_1,\dots,e_n)AT
= (f_1,\dots,f_n) T^{-1}AT
\]
  となり、$B = T^{-1}AT$ がわかる。
  <br>
  すなわち、基底を $(e_1,\dots,e_n)$ から $(f_1,\dots,f_n)$ に取り替えると、表示行列が
  $A$ から $T^{-1}AT$ に変わる。
  <br>
  この形は、行列の対角化で出てきたものと同じものである。
  <br>
ということで、行列の対角化は、一次変換の表示行列を基底の取り換えで対角行列にするという意味であった。
<p>
具体例として、二次形式の標準形でも出てきた場合を調べよう。実対称行列
\[
A = \begin{pmatrix}
a & b\\
b & c
\end{pmatrix}
\]
の定める一次変換を $\phi$ とする。すなわち、$\phi(v) = Av$ ($v \in {\mathbb{R}}^2$) である。
<br>
新たな基底として、標準基底を角 $\theta$ 回転させた
\[
f_1 = \begin{pmatrix}
\cos\theta\\
\sin\theta
\end{pmatrix},
f_2 = \begin{pmatrix}
-\sin\theta\\
\cos\theta
\end{pmatrix}
\]
を取ると、
  \[
  (f_1,f_2) = (e_1,e_2)T,
  \quad
  T = \begin{pmatrix} \cos\theta & -\sin\theta\\
  \sin\theta & \cos\theta \end{pmatrix}
  \]
 となり、これに $\phi$ を施した
  \[
  (\phi(f_1),\phi(f_2)) = (\phi(e_1),\phi(e_2)) T
  = (e_1,e_2)AT = (f_1,f_2) T^{-1}AT
  \]
から、$T^{-1}AT$ という形を得る。これを計算すれば、
\[
T^{-1}AT = \begin{pmatrix} \cos\theta & \sin\theta\\
-\sin\theta & \cos\theta \end{pmatrix}
\begin{pmatrix}
a & b\\
b & c
\end{pmatrix}
  \begin{pmatrix} \cos\theta & -\sin\theta\\
\sin\theta & \cos\theta \end{pmatrix}
= \begin{pmatrix}
(a+c)/2 + \cos(2\theta) (a-c)/2 + b\sin(2\theta) &
b\cos(2\theta) + \sin(2\theta) (c-a)/2\\
b\cos(2\theta) + \sin(2\theta) (c-a)/2 &
(a+c)/2 - b\sin(2\theta) + \cos(2\theta) (c-a)/2
\end{pmatrix}
\]
となるので、$T^{-1}AT$ が対角行列になるのは
\[
2b\cos(2\theta) + (c-a)\sin(2\theta) = 0
\]
のときで、
\[
(\cos(2\theta),\sin(2\theta)) \perp (2b,c-a) \iff
(\cos(2\theta),\sin(2\theta)) \parallel (a-c.2b) \iff
(\cos(2\theta),\sin(2\theta)) = \pm \frac{1}{\sqrt{4b^2 + (a-c)^2}} (a-c,2b).
\]
$\pm$ の違いは、ベクトル $(\cos(2\theta),\sin(2\theta))$ の向きの選び方の問題で本質的ではないので、$+$ の方を取れば、
対角成分（固有値）は、
\begin{align*}
\frac{a+c}{2} + \frac{a-c}{2} \cos(2\theta) + b\sin(2\theta)
&= \frac{a+c}{2} + \frac{1}{2}\sqrt{4b^2 + (a-c)^2}\\
\frac{a+c}{2} + \frac{c-a}{2}\cos(2\theta) - b\sin(2\theta)
&= \frac{a+c}{2} - \frac{1}{2}\sqrt{4b^2 + (a-c)^2}
\end{align*}
となる。
  <p>
以上のことを、$a$, $b$, $c$ に具体的な値を入れていろいろ確かめることで、稽古せよ。
<p>
  次回は１月１１日で、３回目の試験となります。型にはまった計算主体の範囲なので、十分練習の上、点数の上積みを。
<p>
  質問等は (moodle 経由でない）メールでも。
<p> 動画への <a target="_blank" href="https://youtu.be/bR4DGouIjXw">リンク１</a>と
  <a target="_blank" href="https://youtu.be/PR5TO9J33KM">リンク２</a>です。
  解像度が悪いので、感じだけでもどうぞ。
</p>


<h3>
<a NAME="l11"></a>１月１１日（まとめと試験３）</h3>
<p>
  穏やかに冬晴れて、木の葉舞う中、ロウバイは花の準備に怠りなく。
<p>
  今日は、復習のあとで、３回目の試験でした。
  期末試験まで残すところわずか。
<p>
  <a target="_blank" href="https://math.libretexts.org/Bookshelves">LibreTexts</a>というのを見つけました。
  工事中だったり、玉石混交のようですが復習のお供に。
<p>
  [試験の講評] $\fbox{1}$ は、直前の復習が効いたか、吐き出し法で処理しているひとが多かったように思いますが、
  行列式でも構いません。ただ、一次独立だけでは基底にならないので、そこの説明が必要になりますが、そこまで書いてある人は多くはありませんでした。
    <br>
    $\fbox{2}$ は、補講時の内容を復習していれば、単純計算ということになります。
    具体的な回転角で問題は出しましたが、一般的な角で計算してそのあとで代入する方が間違いが少ないかも知れません。
    元の行列と回転角の関係が特別なときは、対角行列にできない場合もでてきます。
    そこまで理解していた人は、ごく少数だったでしょうか。
    <p>
    これまで３回の試験の合計点が７点以下の人は要注意です。期末試験は１２点満点なので、挽回の余地はありますが、
    これまでの蓄えが不足していいる人には厳しいかも知れません。
    <br>
    急病などで試験を欠席する場合は、それを示す客観的な何かを確保しておき、メールでご連絡ください。
</p>


<h3>
<a NAME="l12"></a>１月１８日（確率行列と不変部分空間）</h3>
神々しく輝く鈴鹿の峰々、スーパーの陳列は見かけだけの季節感。
<p>
  予定を少し変更して、確率行列と不変部分空間です。要約の１０節を中心に、確率分布が定常値に収束すること、および定常分布の形について学びます。
  これは詳しく調べるとけっこう長くなるのですが、授業ではその要点を一次変換の行列表示と結びつけて、筋を追ってみます。
<p>
  次回は、これの続きと期末試験前の総復習をします。
 </p>



<h3>
<a NAME="l13"></a>１月２５日（総復習）</h3>
<p>
  雪雲来たりて梅もとまどいながら、季節はまた一歩前に。
<p>
 前回のポイントのいくつかと、後期で学んだ項目を駆け足で。
 直交分解に関連した補足説明を少々。
<p>
  次回の４回目試験は、復習の中から２−３題、確率行列のところから１−２題の合計４題の予定です。
  時間は通常の２倍、点数も２倍（ボーナス点まで入れると３倍）。
<p>
  体調不良者などを対象にした追試は２月８日（木）に実施の予定です。
  該当者はメールでご連絡ください。事後でよいので欠席届けを出していただくことで、受けられるようにしたいと思います。
</p>

<h3>
<a NAME="l14"></a>２月１日（試験４）</h3>
<p>
  寒風吹き抜ける中、最後の試験を行いました。
<p> 
  今回の点数も moodle で確認できます。総計１２点以上が合格。
  合格者の成績区分ですが、ボーナス点も加味した点数で判定しますが、同点者を期末試験の試験の得点でさらに分けることもあります。
  <br>
  個々の問題の点数ですが、概ねできていれば２点、そうでなければ０点ですが、判断に迷った場合は１点です。
  （したがって、解くきっかけの意味で入れてある出だしの設問だけを正答しても、それだけでは点数になりません。）
  <br>
  ただこうすると、2点が切り上げの点数となるため、成績上位者の点数は実態よりも高くなります。
  それを補正する意味もあり、とくによい解答には３点をつけています。
  <br>
  ということで、総得点が２０点の場合、上の方の成績にはなりますが、最上位の評価とはなりません。
<p>
  [講評]：
  <br>
  $\fbox{1}$ 固有値の説明で、行列式を使った方程式の解であるとするものがかなりいました。
  これは固有値の性質ではありますが、定義ではありません。
  対角化と固有ベクトルの関係も明確に述べた人はごく少数でした。
<br>
$\fbox{2}$
基底についての明確な定義があるのは半数くらい。成分の定義の方は、さらにその半分以下。
「ベクトルを基底で表わしたときの係数」といった曖昧な書き方をする人が目立ちました。
正規直交基底による成分の内積表示を正しく書いた人はほとんどいませんでした。
<br>
$\fbox{3}$ 基本的に計算問題ですが、$1$ が固有値であることは、１月１８日に説明したことを使えば簡単です。
そう書いた人は、これも少なかった。
<br>
$\fbox{4}$ ２次確率行列の問題です。それなりの計算量になりますが、入試問題を考えれば決して多くはありません。
一般項の導出までたどりついた人は、２割以下だったでしょうか。それでも、上で述べた「採点基準」により、２点の人数はそれなりの数に。
<br>
全体をみて気になった言い方に、「・・・と言える。」というのが目につきました。
数学的事実を述べるときはこのようなぼかした言い方はせず、「・・・である。」と断定します。
<br>
「題意から」という言い方も複数ありました。これは高校（予備校？）での悪しき指導の影響だとは思いますが、
「題意」という言葉からは何を問題にしているのかが不明です。「これこれの条件から」「これこれの仮定から」
のように根拠となることを具体的に書きます。手間を惜しんではいけません。
</p>

<hr><a href="../teaching.html">上の階へ</a>
</body>
</html>


